<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="WOOHWAHAE Archive — 생각의 기록. 슬로우 라이프의 에세이와 실천.">
  <title>Archive — WOOHWAHAE</title>
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#FAFAF7">
  <link rel="apple-touch-icon" href="/assets/img/icon-192.png">
  <link rel="icon" href="../assets/img/symbol.jpg" type="image/jpeg">
  <link rel="stylesheet" href="../assets/css/style.css">
</head>

<body>

  <nav>
    <a href="/" class="nav-logo">
      <img src="../assets/img/symbol.jpg" class="nav-symbol" alt="WOOHWAHAE">
    </a>
    <ul class="nav-links">
      <li><a href="../archive/" class="active">Archive</a></li>
      <li><a href="../service.html">Service</a></li>
      <li><a href="../about.html">About</a></li>
      <li><a href="../contact.html">Contact</a></li>
    </ul>
    <button class="nav-toggle" aria-label="Menu">
      <span></span><span></span><span></span>
    </button>
  </nav>

  <!-- Archive Header -->
  <div class="container--wide">
    <header class="archive-header">
      <h1 class="archive-title fade-in">Archive</h1>
      <p class="archive-subtitle fade-in">생각의 기록.</p>
    </header>
  </div>

  <!-- Archive Controls -->
  <div class="container--wide">
    <div class="archive-controls">
      <input type="text" class="archive-search" id="archive-search" placeholder="Search..." aria-label="검색">
      <div class="archive-filters" id="archive-filters">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="essay">Essay</button>
        <button class="filter-btn" data-filter="practice">Practice</button>
        <button class="filter-btn" data-filter="manifesto">Manifesto</button>
      </div>
    </div>
    <p class="archive-count" id="archive-count"></p>
  </div>

  <!-- Archive Grid (Magazine B 스타일) -->
  <div class="container--wide">
    <div class="archive-grid" id="archive-grid"></div>
    <p class="archive-empty" id="archive-empty" style="display:none;">검색 결과가 없습니다.</p>
  </div>

  <!-- Footer -->
  <footer class="section--light">
    <div class="footer-grid">
      <div class="footer-brand">
        <img src="../assets/img/symbol.jpg" alt="WOOHWAHAE" width="28" class="footer-brand-symbol">
        <p class="footer-brand-name">WOOHWAHAE</p>
        <p class="footer-brand-desc">Archive for Slow Life</p>
      </div>
      <div>
        <p class="footer-nav-title">Navigate</p>
        <ul class="footer-nav-list">
          <li><a href="../archive/">Archive</a></li>
          <li><a href="../service.html">Service</a></li>
          <li><a href="../about.html">About</a></li>
          <li><a href="../contact.html">Contact</a></li>
        </ul>
      </div>
      <div>
        <p class="footer-connect-title">Connect</p>
        <ul class="footer-connect-list">
          <li><a href="https://instagram.com/woohwahae" target="_blank" rel="noopener">Instagram</a></li>
          <li><a href="https://map.naver.com/p/entry/place/1017153611?lng=129.3497445&lat=35.5592547&placePath=/stylist"
              target="_blank" rel="noopener">Booking</a></li>
          <li><a href="mailto:hello@woohwahae.kr">Email</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p class="footer-bottom-copy">&copy; 2026 WOOHWAHAE &middot; Archive for Slow Life</p>
    </div>
  </footer>

  <script src="../assets/js/main.js"></script>
  <script>
    /* Archive 페이지 — index.json에서 동적 렌더링 */
    (function () {
      const grid = document.getElementById('archive-grid');
      const emptyMsg = document.getElementById('archive-empty');
      const countEl = document.getElementById('archive-count');
      const searchInput = document.getElementById('archive-search');
      const filtersEl = document.getElementById('archive-filters');

      let posts = [];
      let activeFilter = 'all';

      fetch('index.json')
        .then(r => r.json())
        .then(data => {
          posts = data;
          render();
          bindEvents();
        })
        .catch(() => {
          grid.innerHTML = '<p class="archive-empty">아카이브를 불러오지 못했습니다.</p>';
        });

      function render() {
        const query = (searchInput.value || '').toLowerCase();
        const filtered = posts.filter(p => {
          const matchFilter = activeFilter === 'all' || p.category.toLowerCase() === activeFilter;
          const matchSearch = !query ||
            p.title.toLowerCase().includes(query) ||
            p.preview.toLowerCase().includes(query) ||
            (p.issue || '').toLowerCase().includes(query);
          return matchFilter && matchSearch;
        });

        grid.innerHTML = '';

        if (filtered.length === 0) {
          emptyMsg.style.display = 'block';
          countEl.textContent = '';
        } else {
          emptyMsg.style.display = 'none';
          countEl.textContent = filtered.length + ' issues';
        }

        filtered.forEach(post => {
          const card = document.createElement('a');
          card.href = post.slug + '/';
          card.className = 'archive-card fade-in';
          card.innerHTML = `
            <div class="archive-card-image">
              <div style="width:100%;height:100%;background:var(--bg-dark);"></div>
            </div>
            <div class="archive-card-meta">
              <span>${post.issue}</span>
              <span>${post.category}</span>
            </div>
            <h3 class="archive-card-title">${post.title}</h3>
            <p class="archive-card-preview">${post.preview}</p>
          `;
          grid.appendChild(card);
        });

        /* fade-in 등록 */
        grid.querySelectorAll('.fade-in').forEach(el => {
          const obs = new IntersectionObserver(([e]) => {
            if (e.isIntersecting) { e.target.classList.add('visible'); obs.unobserve(e.target); }
          }, { threshold: 0.1 });
          obs.observe(el);
        });
      }

      function bindEvents() {
        filtersEl.addEventListener('click', e => {
          if (!e.target.classList.contains('filter-btn')) return;
          filtersEl.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          e.target.classList.add('active');
          activeFilter = e.target.dataset.filter;
          render();
        });

        let debounce;
        searchInput.addEventListener('input', () => {
          clearTimeout(debounce);
          debounce = setTimeout(render, 200);
        });
      }
    })();
  </script>

</body>

</html>